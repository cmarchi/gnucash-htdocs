<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>2.6. データのバックアップとリカバリー</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="GnuCashチュートリアル・コンセプトガイド"><link rel="up" href="chapter_basics.html" title="第2章 基礎"><link rel="prev" href="basics-files1.html" title="2.5. 財務データの保存"><link rel="next" href="basics-together1.html" title="2.7. まとめ"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.6. データのバックアップとリカバリー</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="basics-files1.html">&lt;&lt;&lt; 前のページ</a> </td><th width="60%" align="center">第2章 基礎</th><td width="20%" align="right"> <a accesskey="n" href="basics-together1.html">次のページ &gt;&gt;&gt;</a></td></tr></table><hr></hr></div><div class="sect1" title="2.6. データのバックアップとリカバリー"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="basics-backup1"></a>2.6. データのバックアップとリカバリー</h2></div></div></div><p><strong class="application"><code>GnuCash</code></strong>は、データが無くならないのを確実にするためにいくつかの種類のファイルを作成します。
<code class="filename">.gnucash</code>ファイルを保存しているフォルダーを参照すると、<strong class="application"><code>GnuCash</code></strong>によって作成される次の拡張子の他のファイルを見つけることができます。
一次データファイルと同じディレクトリ内にある<code class="filename">.gnucash</code>、<code class="filename">.log</code>、<code class="filename">.LCK</code>、<code class="filename">.LNK</code>です。
それぞれのファイルが何をするかを次に説明します。</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">注記</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">次の項は<acronym class="acronym">XML</acronym>形式で財務データを保存している場合にだけ関係します。</p></td></tr></table></div><pre class="programlisting">
      $ ls 
      myfile.gnucash
      myfile.gnucash.20100414185747.gnucash
      myfile.gnucash.20100414223248.log
      myfile.gnucash.20100415114340.gnucash
      myfile.gnucash.20100415154508.log
      myfile.gnucash.20100415173322.gnucash
      myfile.gnucash.20100415194251.log
      myfile.gnucash.7f0982.12093.LNK
      myfile.gnucash.LCK
    </pre><div class="sect2" title="2.6.1. バックアップファイル (.gnucash)"><div class="titlepage"><div><div><h3 class="title"><a name="basics-backupxac2"></a>2.6.1. バックアップファイル (.gnucash)</h3></div></div></div><p>データファイルを保存したときは毎回、バックアップコピーが拡張子<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>で保存されます。
このバックアップファイル前のデータファイルの完全な複製です。そして、ファイル名の形式はバックアップのデータファイル、年、月、日、および時間を表します。
例えば、ファイル名<code class="filename">myfile.gnucash.20100414185747.gnucash</code>は、2010年4月14日午後6時57分47秒に保存された<code class="filename">myfile</code>ファイルのバックアップコピーであることを示します。</p><p>古いバックアップファイルを復元するためには、単に戻りたい日時の<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>ファイルを開いてください。
必ず異なった名前でこのファイルを保存してください。</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">注記</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns=""><strong class="application"><code>GnuCash</code></strong>バージョン2.3.15以前は実際の拡張子<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>の代わりに古い拡張子<code class="filename">.YYYYMMDDHHMMSS.xac</code>を使用してバックアップファイルを作成します。
よって、2.2系列から2.4系列にアップグレードした場合、ディレクトリ内に<code class="filename">.YYYYMMDDHHMMSS.xac</code>と<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>で終わる両方のバックアップファイルがあるかもしれません。</p></td></tr></table></div></div><div class="sect2" title="2.6.2. ログファイル (.log)"><div class="titlepage"><div><div><h3 class="title"><a name="basics-backuplog2"></a>2.6.2. ログファイル (.log)</h3></div></div></div><p><strong class="application"><code>GnuCash</code></strong>でファイルを開くと毎回、<code class="filename">.log</code>ファイルが<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>バックアップファイルと同じ名前形式で作成・保存されます。
開いているデータファイルへの変更を行うとき、ログファイルはそれらの変更だけを保存します。
ログファイルはデータファイルのフルバックアップではありません。単に現在の<strong class="application"><code>GnuCash</code></strong>セッション中にデータファイルに行った変更を記録します。</p><p>停電やシステム全体のクラッシュのためうっかり<strong class="application"><code>GnuCash</code></strong>を終了してしまったとしても、このログファイルを使用することで<strong class="application"><code>GnuCash</code></strong>ファイルを保存した最後の時以降の作業の大部分を回復することが可能です。
手順は次のようになります。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>最後に保存した<strong class="application"><code>GnuCash</code></strong>ファイルを開きます。</p></li><li class="listitem"><p><span class="guimenu"><strong>ファイル</strong></span> → <span class="guisubmenu"><strong>インポート</strong></span> → <span class="guimenuitem"><strong>GnuCashの.logファイルをリプレイ</strong></span>を選択し、今開いている保存済みファイルと同じ日時を持つログファイルを選択します。
確実に正しい.logファイルを選んでください。さもなければ、勘定科目が大きく破壊されるかもしれません。</p></li></ol></div><p>ログリプレイは最後の保存以降に入力された残高に影響するどんな取引も回復します。予定取引とビジネス機能(得意先請求書、仕入先請求書など)から作成されたものを含みます。</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/warning.png"></img></td><th align="left" valign="top">警告</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">予定取引、得意先請求書または仕入先請求書自体への変更は回復されません。回復された取引は、適切に関連付けられないかもしれません。したがって、再確認するべきです。
特にビジネス取引ではいくつかを削除して作り直さなければならないかもしれません。
そうしないと、貸借残高が正しくなったにもかかわらず帳票は正しくないかもしれません。</p></td></tr></table></div></div><div class="sect2" title="2.6.3. ロックファイル(.LNKと.LCK)"><div class="titlepage"><div><div><h3 class="title"><a name="basics-backuplock2"></a>2.6.3. ロックファイル(.LNKと.LCK)</h3></div></div></div><p>時折<code class="filename">.LNK</code>と<code class="filename">.LCK</code>ファイルが現れるのを見るかもしれません。
これらはデータを全く保存していません。二人以上のユーザーが同時に同じファイルを開くのを防ぐために作成されます。
ファイルを開くと、他の誰もアクセスできないようロックするために、これらのファイルが自動的に作成されます。
<strong class="application"><code>GnuCash</code></strong>セッションを閉じるか、または別のファイルを開くと、<strong class="application"><code>GnuCash</code></strong>は、<code class="filename">.LCK</code>と<code class="filename">.LNK</code>ファイルを削除することによって、最初のデータファイルをアンロックします。</p><p>データファイルを開いている際に<strong class="application"><code>GnuCash</code></strong>がクラッシュすると、<code class="filename">.LCK</code>および<code class="filename">.LNK</code>ファイルは削除されません。
<strong class="application"><code>GnuCash</code></strong>で次に開こうとすると、ファイルがロックされているという警告メッセージが表示されます。
<code class="filename">.LNK</code>と<code class="filename">.LCK</code>ファイルがまだディレクトリに存在するので、警告メッセージが表示されます。
ファイルを開くために<span class="guibutton">はい</span>を選択しても安全です。しかし<code class="filename">.LNK</code>と<code class="filename">.LCK</code>ファイルを削除するべきです(端末ウィンドウまたはファイルマネージャーを使用してください)。
それらのファイルがいったん削除されると、<strong class="application"><code>GnuCash</code></strong>がクラッシュしない限り、再び警告メッセージは表示されることはありません。</p></div><div class="sect2" title="2.6.4. ファイル管理"><div class="titlepage"><div><div><h3 class="title"><a name="basics-backupmanage2"></a>2.6.4. ファイル管理</h3></div></div></div><p>どのファイルを取っておくべきでしょうか?
もちろん主データファイルを取っておいてください。
最近の<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>バックアップファイルをいくつか取っておくのは名案です。<code class="filename">.log</code>ファイルはデータの完全なコピーではないので安全に削除することができます。</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">注記</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">また、<strong class="application"><code>GnuCash</code></strong>のバージョンを2.4より前からアップグレードしたなら、古い<code class="filename">.xac</code>形式のバックアップファイルも取っておいてください。
これらのファイルに関しては、<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>バックアップファイルのために上で説明したのと同じ原則を適用できます。</p></td></tr></table></div><p>また、<strong class="application"><code>GnuCash</code></strong>を閉じた後に<code class="filename">.LCK</code>と<code class="filename">.LNK</code>ファイルがある場合はこれらも削除するべきです。
手動で別のディスクにデータファイルをバックアップすると決めるなら
(<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>バックアップファイルでなく)
主データファイルだけをバックアップすれば十分です。</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">注記</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">デフォルトでは、<strong class="application"><code>GnuCash</code></strong>は31日以上前の<code class="filename">.log</code>と<code class="filename">.YYYYMMDDHHMMSS.gnucash</code>バックアップファイルを自動的にすべて削除します。
<span class="guimenu"><strong>編集</strong></span> → <span class="guimenuitem"><strong>設定</strong></span>
(Mac OS X では
<span class="guimenu"><strong>GnuCash</strong></span> → <span class="guimenuitem"><strong>設定</strong></span>)にある<span class="guilabel"><strong>全般</strong></span>タブで<strong class="application"><code>GnuCash</code></strong>のこの動作を変えることができます。</p></td></tr></table></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="basics-files1.html">&lt;&lt;&lt; 前のページ</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right"> <a accesskey="n" href="basics-together1.html">次のページ &gt;&gt;&gt;</a></td></tr><tr><td width="40%" align="left">2.5. 財務データの保存 </td><td width="20%" align="center"><a accesskey="u" href="chapter_basics.html">上に戻る</a></td><td width="40%" align="right"> 2.7. まとめ</td></tr></table></div></body></html>
